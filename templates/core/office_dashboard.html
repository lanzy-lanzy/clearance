{% extends "base.html" %}
{% block title %}Office Dashboard{% endblock %}

{% block sidebar %}
{% include "components/office_sidenav.html" %}
{% endblock %}
{% block content %}
  <!-- Main content area -->
  <div class="flex-1 p-6 overflow-auto">
    <h2 class="text-2xl font-bold mb-4">Dashboard - {{ office.name }}</h2>
    <table class="min-w-full bg-white border">
      <thead>
        <tr>
          <th class="py-2 px-4 border">Student ID</th>
          <th class="py-2 px-4 border">Student Name</th>
          <th class="py-2 px-4 border">Status</th>
          <th class="py-2 px-4 border">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for cr in clearance_requests %}
        <tr>
          <td class="py-2 px-4 border">{{ cr.student.student_id }}</td>
          <td class="py-2 px-4 border">{{ cr.student.user.get_full_name }}</td>
          <td class="py-2 px-4 border">{{ cr.get_status_display }}</td>
          <td class="py-2 px-4 border">
            {% if cr.status == 'pending' %}
            <form method="POST">
              {% csrf_token %}
              <input type="hidden" name="clearance_request_id" value="{{ cr.id }}">
              <button type="submit" name="action" value="approve" class="bg-green-500 text-white px-4 py-2 rounded mr-2">
                Approve
              </button>
              <button type="submit" name="action" value="deny" class="bg-red-500 text-white px-4 py-2 rounded">
                Deny
              </button>
            </form>
            {% else %}
              <span class="text-gray-600">No action available</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
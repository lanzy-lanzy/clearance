{% extends 'admin/base_admin.html' %}

{% block admin_content %}
<div class="space-y-6">
	<!-- Clearance Statistics -->
	<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
		<div class="bg-white rounded-lg shadow-md p-6">
			<div class="flex items-center">
				<div class="p-3 rounded-full bg-yellow-100">
					<svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
				</div>
				<div class="ml-4">
					<p class="text-gray-500">Pending Requests</p>
					<p class="text-2xl font-semibold text-gray-700">{{ pending_count }}</p>
				</div>

			</div>
		</div>

		<div class="bg-white rounded-lg shadow-md p-6">
			<div class="flex items-center">
				<div class="p-3 rounded-full bg-emerald-100">
					<svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
				</div>
				<div class="ml-4">
					<p class="text-gray-500">Approved</p>
					<p class="text-2xl font-semibold text-gray-700">{{ approved_count }}</p>
				</div>

			</div>
		</div>

		<div class="bg-white rounded-lg shadow-md p-6">
			<div class="flex items-center">
				<div class="p-3 rounded-full bg-red-100">
					<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
				</div>
				<div class="ml-4">
					<p class="text-gray-500">Denied</p>
					<p class="text-2xl font-semibold text-gray-700">{{ denied_count }}</p>
				</div>

			</div>
		</div>
	</div>

	<!-- Clearance Requests Table -->
	<div class="bg-white rounded-lg shadow-md overflow-hidden">
		<div class="px-6 py-4 border-b border-gray-200">
			<h2 class="text-lg font-semibold text-gray-700">Clearance Requests</h2>
		</div>
		<div class="overflow-x-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead>
					<tr>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Student</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Office</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Reviewed By</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Request Date</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Notes</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y divide-gray-200">
					{% for request in clearance_requests %}
					<tr>
						<td class="px-6 py-4 whitespace-nowrap">
							<div class="text-sm font-medium text-gray-900">{{ request.student.full_name }}</div>
							<div class="text-sm text-gray-500">{{ request.student.student_id }}</div>
						</td>
						<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
							{{ request.office.name }}
						</td>
						<td class="px-6 py-4 whitespace-nowrap">
							<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
								{% if request.status == 'approved' %}bg-emerald-100 text-emerald-800
								{% elif request.status == 'denied' %}bg-red-100 text-red-800
								{% else %}bg-yellow-100 text-yellow-800{% endif %}">
								{{ request.status|title }}
							</span>
						</td>
						<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
							{{ request.reviewed_by.user.get_full_name|default:"Not reviewed" }}
						</td>
						<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
							{{ request.request_date|date:"M d, Y" }}
						</td>
						<td class="px-6 py-4 text-sm text-gray-500">
							{{ request.notes|default:"-" }}
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>

	<!-- Overall Clearance Status -->
	<div class="bg-white rounded-lg shadow-md overflow-hidden">
		<div class="px-6 py-4 border-b border-gray-200">
			<h2 class="text-lg font-semibold text-gray-700">Overall Clearance Status</h2>
		</div>
		<div class="overflow-x-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead>
					<tr>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Student</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Program Chair Approval</th>
						<th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">Cleared Date</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y divide-gray-200">
					{% for clearance in clearances %}
					<tr>
						<td class="px-6 py-4 whitespace-nowrap">
							<div class="text-sm font-medium text-gray-900">{{ clearance.student.full_name }}</div>
							<div class="text-sm text-gray-500">{{ clearance.student.student_id }}</div>
						</td>
						<td class="px-6 py-4 whitespace-nowrap">
							<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {% if clearance.is_cleared %}bg-emerald-100 text-emerald-800{% else %}bg-yellow-100 text-yellow-800{% endif %}">
								{% if clearance.is_cleared %}Cleared{% else %}Pending{% endif %}
							</span>
						</td>
						<td class="px-6 py-4 whitespace-nowrap">
							<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {% if clearance.program_chair_approved %}bg-emerald-100 text-emerald-800{% else %}bg-gray-100 text-gray-800{% endif %}">
								{% if clearance.program_chair_approved %}Approved{% else %}Not Approved{% endif %}
							</span>
						</td>
						<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
							{{ clearance.cleared_date|date:"M d, Y"|default:"-" }}
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
{% endblock %}